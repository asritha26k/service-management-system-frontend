<div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="fw-bold">My Invoices</h2>
      <span class="badge bg-primary">{{ invoices.length }} Total</span>
    </div>
    
    <div class="table-responsive">
      <table class="table table-hover shadow-sm rounded overflow-hidden">
        <thead class="table-light">
          <tr>
            <th>ID</th>
            <th>Request ID</th>
            <th>Service Name</th>
            <th>Service Amount</th>
            <th>Tax</th>
            <th>Total Amount</th>
            <th>Status</th>
            <th>Date</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (invoice of invoices; track invoice.id) {
          <tr>
            <td class="small text-muted">{{ invoice.id.substring(0, 8) }}...</td>
            <td class="small">{{ invoice.requestId.substring(0, 8) }}...</td>
            <td>{{ invoice.serviceName || 'N/A' }}</td>
            <td>₹{{ invoice.serviceAmount | number:'1.2-2' }}</td>
            <td class="text-muted">₹{{ invoice.taxAmount | number:'1.2-2' }}</td>
            <td class="fw-bold">₹{{ invoice.totalAmount | number:'1.2-2' }}</td>
            <td>
              <span class="badge rounded-pill px-3" [ngClass]="invoice.paymentStatus === 'PAID' ? 'bg-success' : 'bg-primary text-white'">
                {{ invoice.paymentStatus }}
              </span>
            </td>
            <td>
              <div>{{ invoice.createdAt | date:'mediumDate' }}</div>
              @if (invoice.paidAt) {
                <small class="text-muted">Paid: {{ invoice.paidAt | date:'short' }}</small>
              }
            </td>
            <td>
              @if (invoice.paymentStatus === 'PENDING') {
              <button 
                      class="btn btn-sm btn-success px-3" 
                      (click)="openPaymentModal(invoice)">Pay Now</button>
              }
            </td>
          </tr>
          } @empty {
          <tr>
             <td colspan="8" class="text-center py-5">
               <i class="bi bi-receipt display-4 d-block mb-2 text-muted"></i>
               No invoices found.
             </td>
          </tr>
          }
        </tbody>
      </table>
    </div>

    <!-- Payment Confirmation Modal -->
    @if (selectedInvoice) {
    <div class="modal d-block" style="background: rgba(0,0,0,0.5); z-index: 1050;">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg">
          <div class="modal-header bg-success text-white border-0">
            <h5 class="modal-title fw-bold">Confirm Payment</h5>
            <button type="button" class="btn-close btn-close-white" (click)="closePaymentModal()"></button>
          </div>
          <div class="modal-body p-4">
            <div class="text-center mb-4">
              <i class="bi bi-credit-card display-1 text-success mb-3"></i>
              <h4 class="fw-bold">Payment Summary</h4>
            </div>
            <div class="card bg-light border-0 p-3 mb-3">
              <div class="d-flex justify-content-between mb-2">
                <span class="text-muted">Invoice ID:</span>
                <span class="fw-bold">{{ selectedInvoice.id.substring(0, 8) }}...</span>
              </div>
              <div class="d-flex justify-content-between mb-2">
                <span class="text-muted">Service Amount:</span>
                <span>₹{{ selectedInvoice.serviceAmount | number:'1.2-2' }}</span>
              </div>
              <div class="d-flex justify-content-between mb-2">
                <span class="text-muted">Tax:</span>
                <span>₹{{ selectedInvoice.taxAmount | number:'1.2-2' }}</span>
              </div>
              <hr>
              <div class="d-flex justify-content-between">
                <span class="fw-bold">Total Amount:</span>
                <span class="fw-bold text-success fs-5">₹{{ selectedInvoice.totalAmount | number:'1.2-2' }}</span>
              </div>
            </div>
            <div class="alert alert-info mb-0">
              <i class="bi bi-info-circle me-2"></i>
              You are about to make a payment. This action cannot be undone.
            </div>
          </div>
          <div class="modal-footer border-0 bg-light p-3">
            <button class="btn btn-link text-secondary text-decoration-none" (click)="closePaymentModal()">Cancel</button>
            <button class="btn btn-success px-4" (click)="confirmPayment()">
              <i class="bi bi-check-circle me-2"></i>Confirm Payment
            </button>
          </div>
        </div>
      </div>
    </div>
    }