<div class="card p-4 shadow-sm" style="max-width: 400px; width: 100%;">
      <h3 class="text-center mb-4">Change Password</h3>
      @if (isForced) {
      <p class="text-center text-warning">You must change your password to continue.</p>
      }
      
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="mb-3">
          <label class="form-label">Current Password</label>
          <input 
            type="password" 
            class="form-control" 
            formControlName="currentPassword"
            [ngClass]="{'is-invalid': form.get('currentPassword')?.touched && form.get('currentPassword')?.invalid}">
          @if (form.get('currentPassword')?.touched && form.get('currentPassword')?.invalid) {
          <div class="invalid-feedback d-block">
            Current password is required (min 6 characters).
          </div>
          }
        </div>

        <div class="mb-3">
          <label class="form-label">New Password</label>
          <input 
            type="password" 
            class="form-control" 
            formControlName="newPassword"
            [ngClass]="{'is-invalid': form.get('newPassword')?.touched && form.get('newPassword')?.invalid}">
          
          <!-- Password Strength Indicator -->
          <div class="mt-2 p-2 bg-light rounded border" *ngIf="form.get('newPassword')?.value">
            <small class="fw-bold d-block mb-1">Password must contain:</small>
            <ul class="list-unstyled mb-0 small">
              <li [class.text-success]="!hasMinLength" [class.text-danger]="hasMinLength">
                <i class="bi" [ngClass]="hasMinLength ? 'bi-x-circle' : 'bi-check-circle'"></i> At least 8 characters
              </li>
              <li [class.text-success]="!hasUpperCase" [class.text-danger]="hasUpperCase">
                <i class="bi" [ngClass]="hasUpperCase ? 'bi-x-circle' : 'bi-check-circle'"></i> Uppercase letter
              </li>
              <li [class.text-success]="!hasLowerCase" [class.text-danger]="hasLowerCase">
                <i class="bi" [ngClass]="hasLowerCase ? 'bi-x-circle' : 'bi-check-circle'"></i> Lowercase letter
              </li>
              <li [class.text-success]="!hasNumber" [class.text-danger]="hasNumber">
                <i class="bi" [ngClass]="hasNumber ? 'bi-x-circle' : 'bi-check-circle'"></i> Number
              </li>
              <li [class.text-success]="!hasSpecialChar" [class.text-danger]="hasSpecialChar">
                <i class="bi" [ngClass]="hasSpecialChar ? 'bi-x-circle' : 'bi-check-circle'"></i> Special character (@$!%*?&)
              </li>
            </ul>
          </div>
          
          @if (form.get('newPassword')?.touched && form.get('newPassword')?.invalid && !form.get('newPassword')?.value) {
          <div class="invalid-feedback d-block">
            New password is required.
          </div>
          }
        </div>

        <div class="mb-3">
          <label class="form-label">Confirm Password</label>
          <input 
            type="password" 
            class="form-control" 
            formControlName="confirmPassword"
            [ngClass]="{'is-invalid': (form.get('confirmPassword')?.touched && form.get('confirmPassword')?.invalid) || (form.hasError('mismatch') && form.get('confirmPassword')?.touched)}">
          @if (form.get('confirmPassword')?.touched && form.get('confirmPassword')?.errors?.['required']) {
          <div class="invalid-feedback d-block">
            Confirm password is required.
          </div>
          }
          @if (form.hasError('mismatch') && form.get('confirmPassword')?.touched && !form.get('confirmPassword')?.errors?.['required']) {
          <div class="invalid-feedback d-block">
            Passwords do not match.
          </div>
          }
        </div>

        <button type="submit" class="btn btn-primary w-100" [disabled]="form.invalid || isLoading">
          {{ isLoading ? 'Updating...' : 'Update Password' }}
        </button>
      </form>
    </div>